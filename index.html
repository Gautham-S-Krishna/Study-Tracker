<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üìò My Study Tracker App</title>
  <link rel="icon" href="icon.png" type="image/png">
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
   <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #222;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      font-size: 2.2rem;
      margin-bottom: 10px;
    }
    .quote-rotator, .day-counter, .time-counter, .daily-goal {
      text-align: center;
      margin-bottom: 10px;
      font-size: 1.05rem;
    }
    .section {
      margin-top: 30px;
    }
    h2 {
      font-size: 1.5rem;
      border-bottom: 2px solid #ddd;
      padding-bottom: 6px;
      margin-bottom: 15px;
    }
    #lectures {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
      padding: 10px 0;
    }
    #lectures label {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #f0f0f0;
      transition: 0.2s;
    }
    #lectures label:hover {
      background: #e0e0ff;
      cursor: pointer;
    }
    input[type="checkbox"] {
      transform: scale(1.2);
    }
    .progress {
      width: 100%;
      background-color: #eee;
      border-radius: 12px;
      overflow: hidden;
      margin: 10px 0 20px;
      height: 22px;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #4caf50, #81c784);
      width: 0%;
      color: #fff;
      text-align: center;
      line-height: 22px;
      font-weight: bold;
    }
    .dark-toggle {
      float: right;
      padding: 8px 12px;
      margin-bottom: 10px;
      border: none;
      background: #222;
      color: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .section label {
      display: block;
      padding: 8px 0;
    }
    .dark-mode {
      background: #1e1e1e;
      color: #eee;
    }
    .dark-mode .container {
      background: #2c2c2c;
    }
    .dark-mode .progress {
      background: #444;
    }
    .dark-mode .progress-bar {
      background: linear-gradient(90deg, #26a69a, #80cbc4);
    }
    .dark-mode input[type="checkbox"]:checked + label {
      background: #444;
    }
    .dark-mode #lectures label {
      background: #333;
      border-color: #555;
    }
    .dark-mode #lectures label:hover {
      background: #444;
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="dark-toggle" onclick="toggleDarkMode()">üåô Toggle Dark Mode</button>
    <h1><i class="fas fa-chart-line"></i> My Study & Habit Tracker</h1>
    <div class="quote-rotator" id="quote"></div>
    <div class="day-counter" id="dayCounter"></div>
    <div class="time-counter" id="timeCounter"></div>
    <div class="daily-goal" id="dailyGoal"></div>
    <div class="section">
      <h2>üé• Statistics Lectures</h2>
      <div class="progress"><div class="progress-bar" id="progress-bar">0%</div></div>
      <div id="lectures"></div>
    </div>
    <div class="section">
      <h2>üóìÔ∏è Daily Habits</h2>
      <label><input type="checkbox" id="wakeUp"> Wake Up at 8:00 AM</label>
      <label><input type="checkbox" id="study1"> Study before lunch</label>
      <label><input type="checkbox" id="napLimit"> Nap less than 1.5 hrs</label>
      <label><input type="checkbox" id="study2"> Study after nap</label>
      <label><input type="checkbox" id="revise"> Revise notes</label>
      <label><input type="checkbox" id="limitGaming"> No gaming before studying</label>
    </div>
  </div>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCWD290CgtT1bt0gqEYfW7ZJ7PQw2XRwOs",
      authDomain: "study-tracker-2b525.firebaseapp.com",
      databaseURL: "https://study-tracker-2b525-default-rtdb.firebaseio.com",
      projectId: "study-tracker-2b525",
      storageBucket: "study-tracker-2b525.firebasestorage.app",
      messagingSenderId: "1076075930994",
      appId: "1:1076075930994:web:a04d8c20102ea933df29eb",
      measurementId: "G-ZQF72WYVTM"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const userId = localStorage.getItem("anonUser") || Math.random().toString(36).substring(2);
    localStorage.setItem("anonUser", userId);

    const quotes = [
      "Success doesn‚Äôt come from what you do occasionally. It comes from what you do consistently. ‚Äî Marie Forleo",
      "Discipline is the bridge between goals and accomplishment. ‚Äî Jim Rohn",
      "You don‚Äôt have to be extreme, just consistent. ‚Äî Unknown",
      "Small steps every day lead to big results. ‚Äî Unknown",
      "Focus on the step in front of you, not the whole staircase. ‚Äî Unknown"
    ];

    function rotateQuote() {
      const quoteBox = document.getElementById("quote");
      const index = Math.floor(Math.random() * quotes.length);
      quoteBox.textContent = quotes[index];
    }
    setInterval(rotateQuote, 5000);
    rotateQuote();

    const examDate = new Date("2025-07-28T13:30:00");

    function updateCountdown() {
      const now = new Date();
      const msRemaining = examDate - now;

      const days = Math.floor(msRemaining / (1000 * 60 * 60 * 24));
      const hours = Math.floor((msRemaining / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((msRemaining / (1000 * 60)) % 60);
      const seconds = Math.floor((msRemaining / 1000) % 60);

      document.getElementById("dayCounter").textContent = `üìÖ Days remaining until exam: ${days}`;
      document.getElementById("timeCounter").textContent = `‚è≥ Time remaining: ${hours}h ${minutes}m ${seconds}s`;

      const totalLectures = 105;
      const totalDays = Math.ceil(msRemaining / (1000 * 60 * 60 * 24));
      const goalPerDay = Math.ceil(totalLectures / totalDays);

      document.getElementById("dailyGoal").textContent = `üéØ Daily Goal: Watch at least ${goalPerDay} lecture${goalPerDay > 1 ? 's' : ''} today to finish before the exam.`;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();

    const totalLectures = 105;
    const lectureDiv = document.getElementById('lectures');

    firebase.database().ref(`users/${userId}/lectures`).once('value').then(snapshot => {
      const data = snapshot.val() || {};
      for (let i = 1; i <= totalLectures; i++) {
        const id = `lecture${i}`;
        const checked = data[id] ? "checked" : "";
        lectureDiv.innerHTML += `<label><input type="checkbox" id="${id}" ${checked}> Lecture ${i}</label>`;
      }
      attachListeners();
      updateProgress();
    });

    function attachListeners() {
      document.querySelectorAll('#lectures input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', () => {
          firebase.database().ref(`users/${userId}/lectures/${cb.id}`).set(cb.checked);
          updateProgress();
        });
      });
    }

    function updateProgress() {
      const checkboxes = document.querySelectorAll('#lectures input[type="checkbox"]');
      let checked = 0;
      checkboxes.forEach(cb => { if (cb.checked) checked++; });
      const percent = Math.floor((checked / totalLectures) * 100);
      const bar = document.getElementById("progress-bar");
      bar.style.width = percent + "%";
      bar.textContent = percent + "%";
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
    }

    function askNotificationPermission() {
      if ("Notification" in window && Notification.permission !== "granted") {
        Notification.requestPermission();
      }
    }
    askNotificationPermission();

    function notifyMe() {
      if ("Notification" in window && Notification.permission === "granted") {
        new Notification("üìå Time to study! Don't forget your daily goals.");
      }
    }
    setInterval(notifyMe, 60 * 60 * 1000);

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log("Service Worker registered", reg))
        .catch(err => console.log("Service Worker registration failed", err));
    }
  </script>
</body>
</html>

